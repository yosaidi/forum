                   ┌────────┐       
                   | Client |
                   └────────┘
                       |
        ┌──────────────────────────────┐  
        | HTTP Request (GET /api/posts)|
        └──────────────────────────────┘
                       |
                       v
┌──────────────────────────────────────────────┐
|                 LogRequests                  |
|  - Wraps ResponseWriter                      |
|  - Records start time                        |
|  - Calls next handler                        |
└──────────────────────────────────────────────┘
                       |
                       v
┌──────────────────────────────────────────────┐  
|          OptionalAuth / RequireAuth          |
|  - Extracts session from cookie              |
|  - Validates session (expiry, user existence)|
|  - Fetches userID and username               |
|  - Creates new context with user info        |
|  - Calls next handler with r.WithContext(ctx)|
└──────────────────────────────────────────────┘
                       |
                       v
┌──────────────────────────────────────────────┐
|                 Actual Handler               |
|  - Handles the request (database queries,    |
|    business logic, returns response)         |
|  - Can access user info via r.Context()      |
└──────────────────────────────────────────────┘
                       |
                       v
┌──────────────────────────────────────────────┐
|                LogRequests (continued)       |
|  - Records duration, status code             |
|  - Reads user info from context              |
|  - Logs: METHOD PATH STATUS DURATION IP USER |
└──────────────────────────────────────────────┘
                       |
                       v
         ┌──────────────────────────┐       
         | Client receives response |
         └──────────────────────────┘
